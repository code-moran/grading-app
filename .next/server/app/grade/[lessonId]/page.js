(()=>{var e={};e.id=2055,e.ids=[2055],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},30930:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>d.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o});var r=t(67096),a=t(16132),l=t(37284),d=t.n(l),i=t(32564),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);t.d(s,n);let o=["",{children:["grade",{children:["[lessonId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,59605)),"C:\\Users\\admin\\projects\\grading-app\\app\\grade\\[lessonId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,66611)),"C:\\Users\\admin\\projects\\grading-app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"C:\\Users\\admin\\projects\\grading-app\\app\\not-found.tsx"]}],c=["C:\\Users\\admin\\projects\\grading-app\\app\\grade\\[lessonId]\\page.tsx"],x="/grade/[lessonId]/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/grade/[lessonId]/page",pathname:"/grade/[lessonId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},29685:(e,s,t)=>{Promise.resolve().then(t.bind(t,58876))},58876:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>GradingPage});var r=t(30784),a=t(9885),l=t(57114),d=t(30869),i=t(51831),n=t(79803),o=t(92032),c=t(52995),x=t(93680),m=t(69518),u=t(39546),g=t(11440),h=t.n(g),b=t(93935);function GradingPage(){let e=(0,l.useParams)(),s=e.lessonId,[t,g]=(0,a.useState)(null),[p,j]=(0,a.useState)([]),[f,v]=(0,a.useState)(null),[N,y]=(0,a.useState)(0),[w,P]=(0,a.useState)({}),[C,_]=(0,a.useState)(""),[k,S]=(0,a.useState)(!1),[I,E]=(0,a.useState)(""),[G,L]=(0,a.useState)(!0),[q,Z]=(0,a.useState)(null),fetchStudents=async()=>{try{L(!0);let e=await fetch("/api/students");if(!e.ok)throw Error("Failed to fetch students");let s=await e.json();j(s.students)}catch(e){console.error("Error fetching students:",e),Z("Failed to load students")}finally{L(!1)}};(0,a.useEffect)(()=>{let e=d.K.find(e=>e.id===s);g(e||null),fetchStudents()},[s]);let T=p.filter(e=>e.name.toLowerCase().includes(I.toLowerCase())||e.registrationNumber.toLowerCase().includes(I.toLowerCase())||e.email&&e.email.toLowerCase().includes(I.toLowerCase())),loadExistingGrade=async(e,s)=>{try{let t=await fetch(`/api/grades?studentId=${e}&exerciseId=${s}`);if(t.ok){let e=await t.json();if(e.grades&&e.grades.length>0){let s=e.grades[0];_(s.feedback||"");let t={};s.gradeCriteria&&s.gradeCriteria.forEach(e=>{t[e.criteriaId]={levelId:e.levelId,points:e.points,comments:e.comments||""}}),P(t)}}}catch(e){console.error("Error loading existing grade:",e)}};(0,a.useEffect)(()=>{if(f&&t){let e=t.exercises[N];loadExistingGrade(f.id,e.id)}},[f,N,t]);let handleGradeChange=(e,s,t)=>{P(r=>({...r,[e]:{...r[e],levelId:s,points:t,comments:r[e]?.comments||""}}))},handleCommentsChange=(e,s)=>{P(t=>({...t,[e]:{...t[e],comments:s}}))},calculateTotalPoints=()=>{if(!t)return 0;let e=t.exercises[N];return e.rubric.criteria.reduce((e,s)=>{let t=w[s.id];return e+(t?.points||0)},0)},calculatePercentage=()=>{if(!t)return 0;let e=t.exercises[N],s=calculateTotalPoints();return Math.round(s/e.maxPoints*100)},getLetterGrade=e=>e>=90?"A":e>=80?"B":e>=70?"C":e>=60?"D":"F",handleSave=async()=>{if(!f||!t){Z("Please select a student and ensure lesson is loaded");return}try{let e=t.exercises[N],s=calculateTotalPoints(),r=calculatePercentage(),a=getLetterGrade(r),l=Object.entries(w).map(([e,s])=>({criteriaId:e,levelId:s.levelId,points:s.points,comments:s.comments})),d=await fetch("/api/grades",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:f.id,lessonId:t.id,exerciseId:e.id,criteriaGrades:l,totalPoints:s,percentage:r,letterGrade:a,feedback:C,gradedBy:"Instructor"})});if(!d.ok){let e=await d.json();throw Error(e.error||"Failed to save grade")}S(!0),setTimeout(()=>S(!1),3e3),P({}),_("")}catch(e){console.error("Error saving grade:",e),Z(e instanceof Error?e.message:"Failed to save grade")}};if(!t)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(i.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Lesson not found"}),r.jsx("p",{className:"text-gray-600",children:"The requested lesson could not be found."})]})});let $=t.exercises[N],A=calculateTotalPoints(),F=calculatePercentage(),M=getLetterGrade(F);return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsx(b.Z,{}),r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between py-4 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(h(),{href:"/instructor",className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[r.jsx(n.Z,{className:"h-4 w-4 mr-2"}),r.jsx("span",{className:"hidden sm:inline",children:"Back to Dashboard"}),r.jsx("span",{className:"sm:hidden",children:"Back"})]}),r.jsx("div",{className:"h-6 w-px bg-gray-300"}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Lesson ",t.number," â€¢ ",t.duration]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[k&&(0,r.jsxs)("div",{className:"flex items-center text-green-600 bg-green-50 px-3 py-2 rounded-lg",children:[r.jsx(o.Z,{className:"h-4 w-4 mr-2"}),r.jsx("span",{className:"text-sm font-medium",children:"Saved!"})]}),(0,r.jsxs)("button",{onClick:handleSave,className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-2.5 rounded-lg text-sm font-semibold hover:shadow-lg transition-all duration-200 flex items-center hover:scale-105",children:[r.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Save Grade"]})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[r.jsx(x.Z,{className:"h-5 w-5 text-blue-600"}),r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Student Selection"})]}),(0,r.jsxs)("div",{className:"relative mb-4",children:[r.jsx(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search students...",value:I,onChange:e=>E(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),q&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-3 py-2 rounded mb-4 text-sm",children:q}),G&&(0,r.jsxs)("div",{className:"flex justify-center items-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"Loading students..."})]}),!G&&!q&&r.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===T.length?r.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:I?"No students found matching your search.":"No students available."}):T.map(e=>(0,r.jsxs)("button",{onClick:()=>v(e),className:`w-full text-left p-3 rounded-md border transition-colors duration-200 ${f?.id===e.id?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("div",{className:"font-medium",children:e.name}),r.jsx("div",{className:"text-sm text-gray-600",children:e.registrationNumber}),e.registrationNumber&&(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Reg: ",e.registrationNumber]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 mt-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[r.jsx(u.Z,{className:"h-5 w-5 text-blue-600"}),r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Exercise"})]}),r.jsx("div",{className:"space-y-2",children:t.exercises.map((e,s)=>(0,r.jsxs)("button",{onClick:()=>y(s),className:`w-full text-left p-4 rounded-lg border-2 transition-all duration-200 ${N===s?"border-blue-500 bg-blue-50 text-blue-900 shadow-md":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[r.jsx("div",{className:"font-semibold mb-1",children:e.title}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Max: ",e.maxPoints," points"]})]},e.id))})]})]}),r.jsx("div",{className:"lg:col-span-3",children:f?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:r.jsx(x.Z,{className:"h-5 w-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Grading: ",f.name]}),r.jsx("p",{className:"text-sm text-gray-500",children:f.registrationNumber})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[r.jsx("p",{className:"font-medium text-gray-900 mb-1",children:$.title}),r.jsx("p",{className:"text-sm text-gray-600",children:$.description})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Assessment Rubric"}),r.jsx("div",{className:"space-y-6",children:$.rubric.criteria.map(e=>(0,r.jsxs)("div",{className:"border-2 border-gray-200 rounded-xl p-5 hover:border-blue-300 transition-colors",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:e.name}),(0,r.jsxs)("span",{className:"bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full",children:[e.weight,"% weight"]})]}),r.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:$.rubric.levels.map(s=>(0,r.jsxs)("button",{onClick:()=>handleGradeChange(e.id,s.id,s.points),className:`p-4 rounded-lg border-2 text-left transition-all duration-200 ${w[e.id]?.levelId===s.id?`${s.color} border-current shadow-md scale-105`:"border-gray-200 hover:border-gray-300 hover:bg-gray-50 hover:shadow-sm"}`,children:[r.jsx("div",{className:"font-semibold text-sm mb-1",children:s.name}),r.jsx("div",{className:"text-xs text-gray-600 mb-2",children:s.description}),(0,r.jsxs)("div",{className:"text-xs font-medium opacity-75",children:[s.points," points"]})]},s.id))}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Feedback Comments"}),r.jsx("textarea",{value:w[e.id]?.comments||"",onChange:s=>handleCommentsChange(e.id,s.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",rows:3,placeholder:"Add specific feedback for this criteria..."})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Overall Feedback"}),r.jsx("textarea",{value:C,onChange:e=>_(e.target.value),className:"w-full p-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",rows:4,placeholder:"Provide overall feedback for the student's work..."})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl shadow-lg p-6 text-white",children:[r.jsx("h3",{className:"text-lg font-bold mb-6",children:"Grade Summary"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"text-center bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[r.jsx("div",{className:"text-3xl font-bold",children:A}),r.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Points Earned"})]}),(0,r.jsxs)("div",{className:"text-center bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[r.jsx("div",{className:"text-3xl font-bold",children:$.maxPoints}),r.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Max Points"})]}),(0,r.jsxs)("div",{className:"text-center bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold",children:[F,"%"]}),r.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Percentage"})]}),(0,r.jsxs)("div",{className:"text-center bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[r.jsx("div",{className:"text-3xl font-bold",children:M}),r.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Letter Grade"})]})]})]})]}):(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-12 text-center border border-gray-100",children:[r.jsx("div",{className:"bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(x.Z,{className:"h-8 w-8 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Select a Student"}),r.jsx("p",{className:"text-gray-600",children:"Choose a student from the sidebar to begin grading."})]})})]})})]})}},59605:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>d,__esModule:()=>l,default:()=>n});var r=t(95153);let a=(0,r.createProxy)(String.raw`C:\Users\admin\projects\grading-app\app\grade\[lessonId]\page.tsx`),{__esModule:l,$$typeof:d}=a,i=a.default,n=i}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,6309,3782,8200,986,2487,7505,3935,869],()=>__webpack_exec__(30930));module.exports=t})();