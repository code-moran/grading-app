"use strict";(()=>{var r={};r.id=4672,r.ids=[4672],r.modules={53524:r=>{r.exports=require("@prisma/client")},20399:r=>{r.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:r=>{r.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:r=>{r.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:r=>{r.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:r=>{r.exports=require("assert")},14300:r=>{r.exports=require("buffer")},6113:r=>{r.exports=require("crypto")},82361:r=>{r.exports=require("events")},13685:r=>{r.exports=require("http")},95687:r=>{r.exports=require("https")},63477:r=>{r.exports=require("querystring")},57310:r=>{r.exports=require("url")},73837:r=>{r.exports=require("util")},59796:r=>{r.exports=require("zlib")},88797:(r,e,t)=>{t.r(e),t.d(e,{headerHooks:()=>g,originalPathname:()=>f,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>x});var s={};t.r(s),t.d(s,{DELETE:()=>DELETE,GET:()=>GET,POST:()=>POST});var n=t(10884),i=t(16132),o=t(95798),u=t(94020),a=t(8192),c=t(15204);async function GET(r,{params:e}){try{let r=await (0,u.getServerSession)(a.L);if(!r?.user||"admin"!==r.user.role)return o.Z.json({error:"Unauthorized. Admin access required."},{status:403});let t=e.id,s=await c._.courseInstructor.findMany({where:{courseId:t},include:{instructor:{include:{user:{select:{id:!0,name:!0,email:!0}}}}}}),n=s.map(r=>({id:r.instructor.id,userId:r.instructor.userId,name:r.instructor.name,email:r.instructor.email,department:r.instructor.department,title:r.instructor.title,assignedAt:r.assignedAt,assignedBy:r.assignedBy}));return o.Z.json({instructors:n},{status:200})}catch(r){return console.error("Error fetching course instructors:",r),o.Z.json({error:"Failed to fetch instructors"},{status:500})}}async function POST(r,{params:e}){try{let t=await (0,u.getServerSession)(a.L);if(!t?.user||"admin"!==t.user.role)return o.Z.json({error:"Unauthorized. Admin access required."},{status:403});let s=e.id,n=await r.json(),{instructorId:i}=n;if(!i)return o.Z.json({error:"Instructor ID is required"},{status:400});let d=await c._.course.findUnique({where:{id:s}});if(!d)return o.Z.json({error:"Course not found"},{status:404});let l=await c._.instructor.findUnique({where:{id:i}});if(!l)return o.Z.json({error:"Instructor not found"},{status:404});if(!l.isApproved)return o.Z.json({error:"Instructor must be approved before assignment"},{status:400});let p=await c._.courseInstructor.findUnique({where:{courseId_instructorId:{courseId:s,instructorId:i}}});if(p)return o.Z.json({error:"Instructor is already assigned to this course"},{status:409});let m=await c._.courseInstructor.create({data:{courseId:s,instructorId:i,assignedBy:t.user.id},include:{instructor:{include:{user:{select:{id:!0,name:!0,email:!0}}}}}});return o.Z.json({message:"Instructor assigned successfully",instructor:{id:m.instructor.id,name:m.instructor.name,email:m.instructor.email,assignedAt:m.assignedAt}},{status:201})}catch(r){return console.error("Error assigning instructor:",r),o.Z.json({error:"Failed to assign instructor"},{status:500})}}async function DELETE(r,{params:e}){try{let t=await (0,u.getServerSession)(a.L);if(!t?.user||"admin"!==t.user.role)return o.Z.json({error:"Unauthorized. Admin access required."},{status:403});let s=e.id,{searchParams:n}=new URL(r.url),i=n.get("instructorId");if(!i)return o.Z.json({error:"Instructor ID is required"},{status:400});return await c._.courseInstructor.delete({where:{courseId_instructorId:{courseId:s,instructorId:i}}}),o.Z.json({message:"Instructor unassigned successfully"},{status:200})}catch(r){return console.error("Error unassigning instructor:",r),o.Z.json({error:"Failed to unassign instructor"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/courses/[id]/instructors/route",pathname:"/api/courses/[id]/instructors",filename:"route",bundlePath:"app/api/courses/[id]/instructors/route"},resolvedPagePath:"C:\\Users\\admin\\projects\\grading-app\\app\\api\\courses\\[id]\\instructors\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:g,staticGenerationBailout:x}=d,f="/api/courses/[id]/instructors/route"}};var e=require("../../../../../webpack-runtime.js");e.C(r);var __webpack_exec__=r=>e(e.s=r),t=e.X(0,[657,8557,5798,7391,5226,8192],()=>__webpack_exec__(88797));module.exports=t})();