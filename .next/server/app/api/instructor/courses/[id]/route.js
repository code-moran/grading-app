"use strict";(()=>{var e={};e.id=9578,e.ids=[9578],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},5343:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>q,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>b});var s={};t.r(s),t.d(s,{GET:()=>GET});var i=t(10884),o=t(16132),u=t(95798),n=t(94020),a=t(8192),c=t(15204);async function GET(e,{params:r}){try{let e=await (0,n.getServerSession)(a.L);if(!e?.user)return u.Z.json({error:"Unauthorized"},{status:401});let t=e.user.role;if("instructor"!==t)return u.Z.json({error:"Forbidden. Instructor access required."},{status:403});let s=r.id,i=await c._.instructor.findUnique({where:{userId:e.user.id}});if(!i)return u.Z.json({error:"Instructor profile not found"},{status:404});let o=await c._.courseInstructor.findUnique({where:{courseId_instructorId:{courseId:s,instructorId:i.id}}});if(!o)return u.Z.json({error:"You are not assigned to this course"},{status:403});let d=await c._.course.findUnique({where:{id:s},include:{lessons:{include:{_count:{select:{exercises:!0,quizAttempts:!0}}},orderBy:{number:"asc"}},subscriptions:{include:{user:{select:{id:!0,name:!0,email:!0,role:!0}},student:{select:{id:!0,name:!0,email:!0,registrationNumber:!0}}},where:{status:"active"}},_count:{select:{lessons:!0,subscriptions:!0}}}});if(!d)return u.Z.json({error:"Course not found"},{status:404});let p={id:d.id,title:d.title,description:d.description,isActive:d.isActive,createdAt:d.createdAt,updatedAt:d.updatedAt,lessons:d.lessons.map(e=>({id:e.id,number:e.number,title:e.title,description:e.description,duration:e.duration,exerciseCount:e._count.exercises,quizAttemptCount:e._count.quizAttempts})),subscribers:d.subscriptions.map(e=>e.user?{id:e.user.id,name:e.user.name,email:e.user.email,role:e.user.role,subscribedAt:e.subscribedAt}:e.student?{id:e.student.id,name:e.student.name,email:e.student.email||"",role:"student",subscribedAt:e.subscribedAt}:null).filter(e=>null!==e),stats:{lessonCount:d._count.lessons,subscriberCount:d._count.subscriptions}};return u.Z.json({course:p},{status:200})}catch(e){return console.error("Error fetching course:",e),u.Z.json({error:"Failed to fetch course"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/instructor/courses/[id]/route",pathname:"/api/instructor/courses/[id]",filename:"route",bundlePath:"app/api/instructor/courses/[id]/route"},resolvedPagePath:"C:\\Users\\admin\\projects\\grading-app\\app\\api\\instructor\\courses\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:m,headerHooks:x,staticGenerationBailout:b}=d,q="/api/instructor/courses/[id]/route"}};var r=require("../../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[657,8557,5798,7391,5226,8192],()=>__webpack_exec__(5343));module.exports=t})();