(()=>{var e={};e.id=5962,e.ids=[5962],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},59494:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(3528);let a=(0,r.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},26303:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(3528);let a=(0,r.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},66223:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=t(67096),a=t(16132),l=t(37284),i=t.n(l),n=t(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let c=["",{children:["admin",{children:["courses",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,12751)),"C:\\Users\\admin\\projects\\grading-app\\app\\admin\\courses\\[id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,66611)),"C:\\Users\\admin\\projects\\grading-app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"C:\\Users\\admin\\projects\\grading-app\\app\\not-found.tsx"]}],d=["C:\\Users\\admin\\projects\\grading-app\\app\\admin\\courses\\[id]\\page.tsx"],x="/admin/courses/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/courses/[id]/page",pathname:"/admin/courses/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2188:(e,s,t)=>{Promise.resolve().then(t.bind(t,63793))},63793:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>CourseDetailPage});var r=t(30784),a=t(9885),l=t(57114),i=t(74284),n=t(7152),o=t(93935),c=t(79803),d=t(92032),x=t(81057),m=t(78937),h=t(91672),u=t(15441),g=t(59494),p=t(26303),b=t(50007),j=t(48973),f=t(35256),y=t(22385),N=t(6087),v=t(83947),w=t(16920),C=t(11440),S=t.n(C);function CourseDetailPage(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),{data:t}=(0,i.useSession)(),C=e.id,[k,E]=(0,a.useState)(null),[Z,A]=(0,a.useState)([]),[_,P]=(0,a.useState)(null),[L,$]=(0,a.useState)(!0),[T,F]=(0,a.useState)(""),[U,D]=(0,a.useState)(!1),[q,I]=(0,a.useState)(!1),[M,O]=(0,a.useState)(new Set),[R,z]=(0,a.useState)({title:"",description:"",basePrice:""}),[J,B]=(0,a.useState)(!1),[G,H]=(0,a.useState)(!1),[V,Q]=(0,a.useState)(!1),[X,K]=(0,a.useState)([]),[W,Y]=(0,a.useState)([]),[ee,es]=(0,a.useState)([]),[et,er]=(0,a.useState)([]),[ea,el]=(0,a.useState)(!1),[ei,en]=(0,a.useState)(null);(0,a.useEffect)(()=>{C&&(fetchCourse(),fetchUnassignedLessons(),fetchAnalytics(),fetchInstructors(),fetchCohorts(),fetchEnrolledCohorts())},[C]);let fetchCourse=async()=>{try{$(!0);let e=await fetch(`/api/courses/${C}`);if(!e.ok)throw Error("Failed to fetch course");let s=await e.json();E(s.course);let t=s.course.price?(parseFloat(s.course.price.toString())/1.1).toFixed(2):"";z({title:s.course.title,description:s.course.description||"",basePrice:t})}catch(e){F(e.message)}finally{$(!1)}},fetchUnassignedLessons=async()=>{try{let e=await fetch("/api/lessons/unassigned");if(e.ok){let s=await e.json();A(s.lessons||[])}}catch(e){console.error("Error fetching unassigned lessons:",e)}},fetchAnalytics=async()=>{try{let e=await fetch(`/api/courses/${C}/analytics`);if(e.ok){let s=await e.json();P(s.analytics)}}catch(e){console.error("Error fetching analytics:",e)}},handleUpdateCourse=async e=>{e.preventDefault();try{let e=await fetch("/api/courses",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:C,title:R.title,description:R.description,basePrice:R.basePrice||null})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to update course")}D(!1),fetchCourse()}catch(e){F(e.message)}},handleDeleteCourse=async()=>{if(confirm("Are you sure you want to delete this course? This will unlink all lessons but not delete them."))try{B(!0);let e=await fetch(`/api/courses/${C}`,{method:"DELETE"});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to delete course")}s.push("/admin/courses")}catch(e){F(e.message),B(!1)}},handleAssignLesson=async e=>{try{let s=await fetch(`/api/courses/${C}/lessons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to assign lesson")}fetchCourse(),fetchUnassignedLessons()}catch(e){F(e.message)}},handleBulkAssignLessons=async()=>{if(0===M.size){F("Please select at least one lesson");return}try{H(!0);let e=Array.from(M).map(e=>fetch(`/api/courses/${C}/lessons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e})}));await Promise.all(e),O(new Set),fetchCourse(),fetchUnassignedLessons()}catch(e){F(e.message)}finally{H(!1)}},toggleLessonSelection=e=>{let s=new Set(M);s.has(e)?s.delete(e):s.add(e),O(s)},fetchInstructors=async()=>{try{let e=await fetch(`/api/courses/${C}/instructors`),s=null;e.ok&&(s=await e.json(),K(s.instructors||[]));let t=await fetch("/api/instructors");if(t.ok){let e=await t.json(),r=new Set((s?.instructors||[]).map(e=>e.id));Y((e.instructors||[]).filter(e=>!r.has(e.id)))}}catch(e){console.error("Error fetching instructors:",e)}},fetchCohorts=async()=>{try{let e=await fetch("/api/cohorts");if(e.ok){let s=await e.json();es(s.cohorts||[])}}catch(e){console.error("Error fetching cohorts:",e)}},fetchEnrolledCohorts=async()=>{try{let e=await fetch(`/api/courses/${C}/cohorts`);if(e.ok){let s=await e.json();er(s.cohorts||[])}}catch(e){console.error("Error fetching enrolled cohorts:",e)}},handleEnrollCohort=async e=>{try{en(e),F("");let s=await fetch(`/api/courses/${C}/enroll-cohort`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cohortId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to enroll cohort")}let t=await s.json();alert(`Successfully enrolled ${t.enrolled} students from cohort. ${t.alreadyEnrolled>0?`${t.alreadyEnrolled} were already enrolled.`:""}`),fetchEnrolledCohorts(),fetchCourse(),el(!1)}catch(e){F(e.message)}finally{en(null)}},handleUnenrollCohort=async e=>{if(confirm("Are you sure you want to unenroll this cohort from the course? This will cancel subscriptions for all students in the cohort."))try{en(e),F("");let s=await fetch(`/api/courses/${C}/enroll-cohort?cohortId=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to unenroll cohort")}let t=await s.json();alert(`Successfully unenrolled ${t.unenrolled} students from cohort.`),fetchEnrolledCohorts(),fetchCourse()}catch(e){F(e.message)}finally{en(null)}},handleAssignInstructor=async e=>{try{let s=await fetch(`/api/courses/${C}/instructors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instructorId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to assign instructor")}fetchInstructors(),Q(!1)}catch(e){F(e.message)}},handleUnassignInstructor=async e=>{try{let s=await fetch(`/api/courses/${C}/instructors?instructorId=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to unassign instructor")}fetchInstructors()}catch(e){F(e.message)}},handleUnassignLesson=async e=>{try{let s=await fetch(`/api/courses/${C}/lessons?lessonId=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to unassign lesson")}fetchCourse(),fetchUnassignedLessons()}catch(e){F(e.message)}};return t?.user?.role!=="admin"?r.jsx(n.Z,{requiredRole:"admin",children:r.jsx("div",{children:"Unauthorized"})}):r.jsx(n.Z,{requiredRole:"admin",children:(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsx(o.Z,{}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(S(),{href:"/admin/courses",className:"flex items-center text-gray-600 hover:text-blue-600 mb-4 transition-colors",children:[r.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Back to Courses"]}),L?(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),r.jsx("span",{className:"text-gray-600",children:"Loading course..."})]}):k?(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:k.title}),k.isActive?(0,r.jsxs)("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[r.jsx(d.Z,{className:"h-4 w-4 mr-1"}),"Active"]}):(0,r.jsxs)("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[r.jsx(x.Z,{className:"h-4 w-4 mr-1"}),"Inactive"]})]}),k.description&&r.jsx("p",{className:"text-gray-600 text-lg mb-4",children:k.description}),null!==k.price&&void 0!==k.price&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("span",{className:"text-3xl font-bold text-blue-600",children:["$",parseFloat(k.price.toString()).toFixed(2)]}),r.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(price inclusive of tax)"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-1"}),k._count.lessons," lessons"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-4 w-4 mr-1"}),k._count.subscriptions," subscribers"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(u.Z,{className:"h-4 w-4 mr-1"}),"Created ",new Date(k.createdAt).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>D(!U),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[r.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,r.jsxs)("button",{onClick:handleDeleteCourse,disabled:J,className:"bg-red-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center disabled:opacity-50",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-2"}),J?"Deleting...":"Delete"]})]})]}):r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-gray-600",children:"Course not found"})})]}),T&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:T}),k&&(0,r.jsxs)(r.Fragment,{children:[U&&(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6 border border-gray-100",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Course"}),(0,r.jsxs)("form",{onSubmit:handleUpdateCourse,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Title *"}),r.jsx("input",{type:"text",required:!0,value:R.title,onChange:e=>z({...R,title:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{value:R.description,onChange:e=>z({...R,description:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Base Price (before tax)"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:R.basePrice,onChange:e=>z({...R,basePrice:e.target.value}),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Price will be stored inclusive of tax (10% tax rate)"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[r.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Save Changes"}),r.jsx("button",{type:"button",onClick:()=>{D(!1);let e=k.price?(parseFloat(k.price.toString())/1.1).toFixed(2):"";z({title:k.title,description:k.description||"",basePrice:e})},className:"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(m.Z,{className:"h-5 w-5 opacity-80"}),r.jsx(b.Z,{className:"h-5 w-5 opacity-80"})]}),r.jsx("div",{className:"text-3xl font-bold",children:k._count.lessons}),r.jsx("div",{className:"text-blue-100 text-sm mt-1",children:"Total Lessons"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(h.Z,{className:"h-5 w-5 opacity-80"}),r.jsx(b.Z,{className:"h-5 w-5 opacity-80"})]}),r.jsx("div",{className:"text-3xl font-bold",children:k._count.subscriptions}),r.jsx("div",{className:"text-green-100 text-sm mt-1",children:"Active Subscribers"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(j.Z,{className:"h-5 w-5 opacity-80"}),r.jsx(b.Z,{className:"h-5 w-5 opacity-80"})]}),r.jsx("div",{className:"text-3xl font-bold",children:k.lessons.reduce((e,s)=>e+s._count.exercises,0)}),r.jsx("div",{className:"text-purple-100 text-sm mt-1",children:"Total Exercises"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(f.Z,{className:"h-5 w-5 opacity-80"}),r.jsx(b.Z,{className:"h-5 w-5 opacity-80"})]}),(0,r.jsxs)("div",{className:"text-3xl font-bold",children:[_?.averageCompletionRate||0,"%"]}),r.jsx("div",{className:"text-orange-100 text-sm mt-1",children:"Completion Rate"})]})]}),_&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[r.jsx(f.Z,{className:"h-5 w-5 text-indigo-600 mr-2"}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Submissions"})]}),r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_.totalSubmissions}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Total exercise submissions"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[r.jsx(j.Z,{className:"h-5 w-5 text-yellow-600 mr-2"}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Quiz Attempts"})]}),r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_.totalQuizAttempts}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Total quiz attempts"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[r.jsx(b.Z,{className:"h-5 w-5 text-green-600 mr-2"}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Engagement"})]}),r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:k._count.subscriptions>0?Math.round(_.totalSubmissions/k._count.subscriptions*10)/10:0}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Avg submissions per student"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Course Lessons"}),(0,r.jsxs)("button",{onClick:()=>I(!q),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[r.jsx(y.Z,{className:"h-4 w-4 mr-2"}),"Add Lessons"]})]}),q&&Z.length>0&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Available Lessons (",Z.length,")"]}),M.size>0&&r.jsx("button",{onClick:handleBulkAssignLessons,disabled:G,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center disabled:opacity-50",children:G?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Assigning..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(N.Z,{className:"h-4 w-4 mr-2"}),"Assign Selected (",M.size,")"]})})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Z.map(e=>(0,r.jsxs)("div",{className:`flex items-center justify-between p-3 bg-white rounded-lg border-2 transition-all ${M.has(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[r.jsx("input",{type:"checkbox",checked:M.has(e.id),onChange:()=>toggleLessonSelection(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"font-medium text-gray-900",children:["Lesson ",e.number,": ",e.title]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e._count.exercises," exercises"]})]})]}),(0,r.jsxs)("button",{onClick:()=>handleAssignLesson(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center ml-2",children:[r.jsx(N.Z,{className:"h-3 w-3 mr-1"}),"Add"]})]},e.id))})]}),0===k.lessons.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(m.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"No lessons assigned to this course"}),Z.length>0&&r.jsx("button",{onClick:()=>I(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Add lessons now"})]}):r.jsx("div",{className:"space-y-3",children:k.lessons.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[r.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:r.jsx(m.Z,{className:"h-5 w-5 text-blue-600"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"font-semibold text-gray-900",children:["Lesson ",e.number,": ",e.title]}),e.description&&r.jsx("div",{className:"text-sm text-gray-600 line-clamp-1",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[(0,r.jsxs)("span",{children:[e._count.exercises," exercises"]}),e.duration&&r.jsx("span",{children:e.duration})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(S(),{href:`/instructor/lesson/${e.id}`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"View"}),(0,r.jsxs)("button",{onClick:()=>handleUnassignLesson(e.id),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[r.jsx(v.Z,{className:"h-3 w-3 mr-1"}),"Remove"]})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Assigned Instructors (",X.length,")"]}),(0,r.jsxs)("button",{onClick:()=>{Q(!V),V||fetchInstructors()},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[r.jsx(y.Z,{className:"h-4 w-4 mr-2"}),"Assign Instructor"]})]}),V&&W.length>0&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900 mb-3",children:["Available Instructors (",W.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:W.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-600",children:e.email}),e.department&&r.jsx("div",{className:"text-xs text-gray-500",children:e.department})]}),(0,r.jsxs)("button",{onClick:()=>handleAssignInstructor(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center ml-2",children:[r.jsx(N.Z,{className:"h-3 w-3 mr-1"}),"Assign"]})]},e.id))})]}),V&&0===W.length&&r.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 text-center",children:r.jsx("p",{className:"text-gray-600",children:"All approved instructors are already assigned"})}),0===X.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(h.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"No instructors assigned to this course"})]}):r.jsx("div",{className:"space-y-3",children:X.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:r.jsx(h.Z,{className:"h-5 w-5 text-purple-600"})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-600",children:e.email}),e.department&&r.jsx("div",{className:"text-xs text-gray-500",children:e.department}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Assigned ",new Date(e.assignedAt).toLocaleDateString()]})]})]}),(0,r.jsxs)("button",{onClick:()=>handleUnassignInstructor(e.id),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[r.jsx(v.Z,{className:"h-3 w-3 mr-1"}),"Unassign"]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Enrolled Cohorts (",et.length,")"]}),(0,r.jsxs)("button",{onClick:()=>el(!ea),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center",children:[r.jsx(y.Z,{className:"h-4 w-4 mr-2"}),"Enroll Cohort"]})]}),ea&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Available Cohorts"}),0===ee.length?r.jsx("p",{className:"text-gray-600 text-sm",children:"No cohorts available."}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:ee.filter(e=>!et.find(s=>s.id===e.id)).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border-2 border-gray-200",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e._count?.students||0," students"]})]}),r.jsx("button",{onClick:()=>handleEnrollCohort(e.id),disabled:ei===e.id,className:"bg-purple-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors flex items-center disabled:opacity-50",children:ei===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1"}),"Enrolling..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(w.Z,{className:"h-3 w-3 mr-1"}),"Enroll"]})})]},e.id))})]}),0===et.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(w.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"No cohorts enrolled in this course"}),ee.length>0&&r.jsx("button",{onClick:()=>el(!0),className:"mt-4 text-purple-600 hover:text-purple-700 font-medium",children:"Enroll cohorts now"})]}):r.jsx("div",{className:"space-y-3",children:et.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[r.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:r.jsx(w.Z,{className:"h-5 w-5 text-purple-600"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[e.enrolledStudents," of ",e.totalStudents," students enrolled"]}),e.description&&r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]})]}),r.jsx("button",{onClick:()=>handleUnenrollCohort(e.id),disabled:ei===e.id,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center disabled:opacity-50",children:ei===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-red-600 mr-1"}),"Unenrolling..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(v.Z,{className:"h-3 w-3 mr-1"}),"Unenroll"]})})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:["Subscribers (",k.subscriptions.length,")"]}),0===k.subscriptions.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(h.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"No subscribers yet"})]}):r.jsx("div",{className:"space-y-3",children:k.subscriptions.map(e=>{let s=null!==e.user,t=s?e.user:e.student,a=s?e.user.role:"student";return t?(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:r.jsx(h.Z,{className:"h-5 w-5 text-green-600"})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold text-gray-900",children:t.name}),r.jsx("div",{className:"text-sm text-gray-600",children:s?t.email:`${t.email||""} (Reg: ${t.registrationNumber})`}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Subscribed ",new Date(e.subscribedAt).toLocaleDateString()]})]})]}),r.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${"student"===a?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:a})]},e.id):null})})]})]})]})]})})}},12751:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var r=t(95153);let a=(0,r.createProxy)(String.raw`C:\Users\admin\projects\grading-app\app\admin\courses\[id]\page.tsx`),{__esModule:l,$$typeof:i}=a,n=a.default,o=n}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,6309,3782,8200,986,8894,6856,7505,3935,7152],()=>__webpack_exec__(66223));module.exports=t})();