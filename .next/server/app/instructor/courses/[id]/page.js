(()=>{var e={};e.id=6356,e.ids=[6356],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},26688:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>d});var r=t(67096),l=t(16132),a=t(37284),i=t.n(a),n=t(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["instructor",{children:["courses",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9513)),"C:\\Users\\admin\\projects\\grading-app\\app\\instructor\\courses\\[id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,66611)),"C:\\Users\\admin\\projects\\grading-app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\admin\\projects\\grading-app\\app\\instructor\\courses\\[id]\\page.tsx"],x="/instructor/courses/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/instructor/courses/[id]/page",pathname:"/instructor/courses/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},95864:(e,s,t)=>{Promise.resolve().then(t.bind(t,62373))},62373:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>InstructorCourseDetailPage});var r=t(30784),l=t(9885),a=t(57114),i=t(74284),n=t(7152),o=t(93935),d=t(79803),c=t(92032),x=t(81057),m=t(78937),h=t(91672),u=t(39546),g=t(35256),p=t(22385),b=t(6087),j=t(16920),f=t(83947),N=t(15441),y=t(11440),v=t.n(y);function InstructorCourseDetailPage(){let e=(0,a.useParams)();(0,a.useRouter)();let{data:s}=(0,i.useSession)(),t=e.id,[y,w]=(0,l.useState)(null),[C,S]=(0,l.useState)([]),[E,_]=(0,l.useState)(!0),[Z,A]=(0,l.useState)(""),[k,P]=(0,l.useState)(!1),[L,q]=(0,l.useState)(new Set),[$,U]=(0,l.useState)(!1),[T,F]=(0,l.useState)([]),[z,O]=(0,l.useState)([]),[D,I]=(0,l.useState)(!1),[M,R]=(0,l.useState)(null);(0,l.useEffect)(()=>{t&&(fetchCourse(),fetchUnassignedLessons(),fetchCohorts(),fetchEnrolledCohorts())},[t]);let fetchCourse=async()=>{try{_(!0);let e=await fetch(`/api/instructor/courses/${t}`);if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to fetch course")}let s=await e.json();w(s.course)}catch(e){A(e.message)}finally{_(!1)}},fetchUnassignedLessons=async()=>{try{let e=await fetch(`/api/lessons/unassigned?excludeCourseId=${t}`);if(e.ok){let s=await e.json();S(s.lessons||[])}}catch(e){console.error("Error fetching available lessons:",e)}},handleAssignLesson=async e=>{try{let s=await fetch(`/api/instructor/courses/${t}/lessons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to assign lesson")}fetchCourse(),fetchUnassignedLessons(),q(new Set)}catch(e){A(e.message)}},handleBulkAssignLessons=async()=>{if(0===L.size){A("Please select at least one lesson");return}try{U(!0);let e=Array.from(L).map(e=>fetch(`/api/instructor/courses/${t}/lessons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e})}));await Promise.all(e),q(new Set),fetchCourse(),fetchUnassignedLessons()}catch(e){A(e.message)}finally{U(!1)}},toggleLessonSelection=e=>{let s=new Set(L);s.has(e)?s.delete(e):s.add(e),q(s)},fetchCohorts=async()=>{try{let e=await fetch("/api/cohorts");if(e.ok){let s=await e.json();F(s.cohorts||[])}}catch(e){console.error("Error fetching cohorts:",e)}},fetchEnrolledCohorts=async()=>{try{let e=await fetch(`/api/courses/${t}/cohorts`);if(e.ok){let s=await e.json();O(s.cohorts||[])}}catch(e){console.error("Error fetching enrolled cohorts:",e)}},handleEnrollCohort=async e=>{try{R(e),A("");let s=await fetch(`/api/courses/${t}/enroll-cohort`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cohortId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to enroll cohort")}let r=await s.json();alert(`Successfully enrolled ${r.enrolled} students from cohort. ${r.alreadyEnrolled>0?`${r.alreadyEnrolled} were already enrolled.`:""}`),fetchEnrolledCohorts(),fetchCourse(),I(!1)}catch(e){A(e.message)}finally{R(null)}},handleUnenrollCohort=async e=>{if(confirm("Are you sure you want to unenroll this cohort from the course? This will cancel subscriptions for all students in the cohort."))try{R(e),A("");let s=await fetch(`/api/courses/${t}/enroll-cohort?cohortId=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to unenroll cohort")}let r=await s.json();alert(`Successfully unenrolled ${r.unenrolled} students from cohort.`),fetchEnrolledCohorts(),fetchCourse()}catch(e){A(e.message)}finally{R(null)}};return E?r.jsx(n.Z,{requiredRole:"instructor",children:(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsx(o.Z,{}),r.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.jsx("div",{className:"flex justify-center items-center py-12",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})]})}):y?r.jsx(n.Z,{requiredRole:"instructor",children:(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsx(o.Z,{}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)(v(),{href:"/instructor/courses",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[r.jsx(d.Z,{className:"h-4 w-4 mr-2"}),"Back to Courses"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:y.title}),y.description&&r.jsx("p",{className:"text-gray-600",children:y.description})]}),r.jsx("div",{className:"flex items-center space-x-2",children:y.isActive?(0,r.jsxs)("div",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[r.jsx(c.Z,{className:"h-4 w-4 mr-1"}),"Active"]}):(0,r.jsxs)("div",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[r.jsx(x.Z,{className:"h-4 w-4 mr-1"}),"Inactive"]})})]})]}),Z&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:Z}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(m.Z,{className:"h-5 w-5 opacity-80"})}),r.jsx("div",{className:"text-3xl font-bold",children:y.stats.lessonCount}),r.jsx("div",{className:"text-blue-100 text-sm mt-1",children:"Total Lessons"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(h.Z,{className:"h-5 w-5 opacity-80"})}),r.jsx("div",{className:"text-3xl font-bold",children:y.stats.subscriberCount}),r.jsx("div",{className:"text-green-100 text-sm mt-1",children:"Active Subscribers"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(u.Z,{className:"h-5 w-5 opacity-80"})}),r.jsx("div",{className:"text-3xl font-bold",children:y.lessons.reduce((e,s)=>e+s.exerciseCount,0)}),r.jsx("div",{className:"text-purple-100 text-sm mt-1",children:"Total Exercises"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(g.Z,{className:"h-5 w-5 opacity-80"})}),r.jsx("div",{className:"text-3xl font-bold",children:y.lessons.reduce((e,s)=>e+s.quizAttemptCount,0)}),r.jsx("div",{className:"text-orange-100 text-sm mt-1",children:"Quiz Attempts"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 md:p-8 border border-gray-100 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Lessons"}),r.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Manage lessons assigned to this course"})]}),(0,r.jsxs)("button",{onClick:()=>P(!k),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-2"}),k?"Hide":"Add"," Lessons"]})]}),k&&C.length>0&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Available Lessons (",C.length,")"]}),L.size>0&&r.jsx("button",{onClick:handleBulkAssignLessons,disabled:$,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center disabled:opacity-50",children:$?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Assigning..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Assign Selected (",L.size,")"]})})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map(e=>(0,r.jsxs)("div",{className:`flex items-center justify-between p-3 bg-white rounded-lg border-2 transition-all ${L.has(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[r.jsx("input",{type:"checkbox",checked:L.has(e.id),onChange:()=>toggleLessonSelection(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"font-medium text-gray-900",children:["Lesson ",e.number,": ",e.title]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e._count.exercises," exercises"]})]})]}),(0,r.jsxs)("button",{onClick:()=>handleAssignLesson(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center ml-2",children:[r.jsx(b.Z,{className:"h-3 w-3 mr-1"}),"Add"]})]},e.id))})]}),k&&0===C.length&&r.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 text-center",children:r.jsx("p",{className:"text-gray-600",children:"No unassigned lessons available"})}),0===y.lessons.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(m.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Lessons Assigned"}),r.jsx("p",{className:"text-gray-600",children:"Add lessons to get started"})]}):r.jsx("div",{className:"space-y-4",children:y.lessons.map(e=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:r.jsx(m.Z,{className:"h-5 w-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Lesson ",e.number,": ",e.title]}),e.description&&r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[(0,r.jsxs)("span",{children:[e.exerciseCount," exercises"]}),e.duration&&r.jsx("span",{children:e.duration}),(0,r.jsxs)("span",{children:[e.quizAttemptCount," quiz attempts"]})]})]})]})}),r.jsx(v(),{href:`/instructor/lesson/${e.id}`,className:"ml-4 text-blue-600 hover:text-blue-700 font-medium text-sm",children:"View Details"})]})},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 md:p-8 border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["Enrolled Cohorts (",z.length,")"]}),(0,r.jsxs)("button",{onClick:()=>I(!D),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Enroll Cohort"]})]}),D&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Available Cohorts"}),0===T.length?r.jsx("p",{className:"text-gray-600 text-sm",children:"No cohorts available."}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:T.filter(e=>!z.find(s=>s.id===e.id)).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border-2 border-gray-200",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e._count?.students||0," students"]})]}),r.jsx("button",{onClick:()=>handleEnrollCohort(e.id),disabled:M===e.id,className:"bg-purple-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors flex items-center disabled:opacity-50",children:M===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1"}),"Enrolling..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(j.Z,{className:"h-3 w-3 mr-1"}),"Enroll"]})})]},e.id))})]}),0===z.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(j.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"No cohorts enrolled in this course"}),T.length>0&&r.jsx("button",{onClick:()=>I(!0),className:"mt-4 text-purple-600 hover:text-purple-700 font-medium",children:"Enroll cohorts now"})]}):r.jsx("div",{className:"space-y-3",children:z.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[r.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:r.jsx(j.Z,{className:"h-5 w-5 text-purple-600"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[e.enrolledStudents," of ",e.totalStudents," students enrolled"]}),e.description&&r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]})]}),r.jsx("button",{onClick:()=>handleUnenrollCohort(e.id),disabled:M===e.id,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center disabled:opacity-50",children:M===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-red-600 mr-1"}),"Unenrolling..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(f.Z,{className:"h-3 w-3 mr-1"}),"Unenroll"]})})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 md:p-8 border border-gray-100",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Subscribers"}),0===y.subscribers.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(h.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Subscribers"}),r.jsx("p",{className:"text-gray-600",children:"No students have subscribed to this course yet"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.subscribers.map(e=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:r.jsx(h.Z,{className:"h-5 w-5 text-purple-600"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),r.jsx("p",{className:"text-sm text-gray-600",children:e.email}),(0,r.jsxs)("div",{className:"flex items-center mt-2 text-xs text-gray-500",children:[r.jsx(N.Z,{className:"h-3 w-3 mr-1"}),"Subscribed ",new Date(e.subscribedAt).toLocaleDateString()]})]})]})},e.id))})]})]})]})}):r.jsx(n.Z,{requiredRole:"instructor",children:(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsx(o.Z,{}),r.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:Z||"Course not found"})})]})})}},9513:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>o});var r=t(95153);let l=(0,r.createProxy)(String.raw`C:\Users\admin\projects\grading-app\app\instructor\courses\[id]\page.tsx`),{__esModule:a,$$typeof:i}=l,n=l.default,o=n}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,9045,1440,3528,8200,986,4395,7134,3935,7152],()=>__webpack_exec__(26688));module.exports=t})();